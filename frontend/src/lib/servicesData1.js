export const HEADERS = [
  "Project Registration",
  "Legal Services",
  "Compliance",
  "Package A",
  "Package B",
  "Package C",
  "Package D",
  "Customized Header"
];

export const SERVICES = {
  "Project Registration":
   [{
    "name": "PROJECT REGISTRATION SERVICES", 
    origin: "Project Registration",
    "subServices": [
      "Consultation and Guidance on Registration Procedures", 
      "Assistance with Online Registration Process", 
      "Preparation of Necessary Undertakings and Affidavits for RERA Registration", 
      "Scrutiny Assistance till RERA Certificate is generated", 
      "Continued support until the RERA Certificate is issued.", 
      "Procurement of CERSAI , Review of certificate as per RERA format."
    ]
  }],
  "Legal Services": [{
    "name": "LEGAL CONSULTATION", 
    origin: "Legal Services",
    "subServices": [
      "Client Meetings: Conducting conference meetings with the client to understand objectives, clarify requirements, and gather necessary inputs.",
      "Review of Agreements for Sale: Examination of the Agreements for Sale executed with existing allottees to assess contractual obligations and relevant clauses.", 
      "Analysis of Sanctioned Layout Plans: Detailed study of the currently sanctioned layout plans to understand the approved development framework.", 
      "Review of Proposed Plans: Evaluation of the proposed revised plans in context with the existing development and approvals.",
      "Assessment of MahaRERA Profile: Review and analysis of the projects profile on the MahaRERA portal to verify past disclosures.",
      "Legal Research on RERA Provisions: In-depth research on the applicable provisions of the Real Estate (Regulation and Development) Act, 2016, with a focus on Section 14(2), including review of relevant judicial precedents.",
      "Legal Consultation and Opinion: Providing a comprehensive legal opinion on the implications of 14(2) of the RERA Act in the context of the project.",
      "Drafting of Consent Letter: Preparation of a draft consent letter for use with allottees, incorporating legal requirements and project-specific considerations."
    ]
  }], 
  "Compliance": [{
    "name": "Change of Promoter",
    origin: "Compliance",
    "subServices": [
      "Change of Promoters as per Section 15: Updating project promoter information in accordance with MahaRERA guidelines.", 
      "Drafting of Annexure A, B, and C: Compiling project-related information into required annexures for MahaRERA submission.", 
      "Drafting of Consent Letter: Formalizing stakeholders approval for project-related changes or actions.", 
      "Follow-up Till Certificate is Generated: Continuous communication with MahaRERA until project certificate issuance.", 
      "Hearing at MahaRERA Office: Attending sessions at MahaRERA to address project-related queries or issues.", 
      "Drafting and Uploading of Correction Application: Rectifying errors in project documentation and re-submitting to MahaRERA.", 
      "Drafting of Format C: Complying with MahaRERA-prescribed document formats for reporting and compliance purposes.", 
      "Scrutiny Assistance Until Certificate is Generated: Providing support during MahaRERA scrutiny process until project certificate issuance"
    ]
  }, {
    "name": "MahaRERA Profile Updation", 
    origin: "Compliance",
    "subServices": [
      "Disclosure of Sold/Unsold Inventory", 
      "Format D Drafting and Uploading", 
      "CERSAI Report Submission", 
      "Drafted Formats for Form 2A", 
      "MahaRERA Profile Update"
    ]
  }, {
    "name": "Correction (Change of FSI)", 
    origin: "Compliance",
    "subServices": [
      "Project Correction under Section 14 (2)", 
      "Consultation regarding RERA Rules and Regulations", 
      "Uploading of all the relevant documents for Project Corrections", 
      "Drafting all the relevant Applications, Undertakings, and Declarations", 
      "Scrutiny Assistance", 
      "Coordinating with the MahaRERA Authorities", 
      "Drafting of a detailed consent letter for correction"
    ]
  }, {
    "name": "MahaRERA Profile Migration", 
    origin: "Compliance",
    "subServices": [
      "Updating the Promoter/Partner(s)/Director(s) Details on the Portal.", 
      "Adding Grievance Officer and Single point of Contact.", 
      "Updation of Project Professional Details, Building Details, Progress of the Project etc.", 
      "Generating & Updating of Form 1 (Architect Certificate), Form 2 (Certificate of Engineer) and Form 3 (CA Certificate).", 
      "Generation of CERSAI Report.", 
      "Drafting and updating Legal & Financial Encumbrances of the project (If any).", 
      "Drafted Formats of Authorized Signatory, Development Plan (DP) Remark Declaration, Financial Encumbrance Letter and Legal Encumbrance Letter.", 
      "Updation and Migration of the old MahaRERA Profile Details to the new RERA website “MahaRERA CRITI”."
    ]
  }, {
    "name": "Removal from Abeyance (QPR)", 
    origin: "Compliance",
    "subServices": [
      "Responding to the MahaRERA Notice", 
      "Representation in Virtual Meetings", 
      "Providing Guidance on RERA Rules and Regulations", 
      "Liaising with MahaRERA Authorities", 
      "Drafting Necessary Applications, Undertakings, and Declarations"
    ]
  }, {
    "name": "Extension of Project Completion Date u/s 7(3)",
    origin: "Compliance", 
    "subServices": [
      "Project Extension under Section 7(3)", 
      "Consultation regarding RERA Rules and Regulations", 
      "Uploading of all the relevant documents for Project Extension", 
      "Drafting of a detailed consent letter for correction", 
      "Scrutiny Assistance"
    ]
  }, {
    "name": "Project Closure",
    origin: "Compliance",
    "subServices": [
      "Project Closure",
      "Consultation regarding RERA Rules and Regulations", 
      "Drafting all the relevant Applications, Undertakings, and Declarations", 
      "Uploading of all the relevant documents for Project Closure"
    ]
  }, {
    "name": "Extension of Project Completion Date u/s 6",
    origin: "Compliance",
    "subServices": [
      "Project Extension under Section 6", 
      "Consultation regarding RERA Rules and Regulations", 
      "Uploading of all the relevant documents for Project Extension", 
      "Scrutiny Assistance"
    ]
  }, {
    "name": "Post Facto Extension",
    origin: "Compliance",
    "subServices": [
      "Project Extension", 
      "Consultation regarding RERA Rules & Regulations", 
      "Uploading all the relevant documents for Project Extension", 
      "Scrutiny Assistance"
    ]
  }, {
    "name": "Extension Under Order 40",
    origin: "Compliance", 
    "subServices": [
      "Order 40 Extension", 
      "RERA Rules Consultation", 
      "Document Compilation and Uploading", 
      "Drafting Services", 
      "Scrutiny Support", 
      "MahaRERA Coordination", 
      "Hearing Representation"
    ]
  }, {
    "name": "Correction (Change of Bank Account)",
    origin: "Compliance", 
    "subServices": [
      "Change of separate bank account as per section 4 (2)(l)(D).", 
      "Drafting of Duly Notarized Declaration-Cum Undertaking as per the format prescribed in 'A'", 
      "Declaration in Format 'A'as per Order No; 34 of 2022 dated 27;07;20222 issued by MahaRERA", 
      "Consultation regarding RERA Rules and Regulations", 
      "Uploading of all the relevant documents for Project Correction", 
      "Drafting all the relevant Applications, Undertakings and Declarations", 
      "Scrutiny Assistance", 
      "Coordinating with the MahaRERA Authorities"
    ]
  }, {
    "name": "Removal from Abeyance (Lapsed)", 
    origin: "Compliance",
    "subServices": [
      "Responding to the MahaRERA Notice", 
      "Representation in Virtual Meetings", 
      "Providing Guidance on RERA Rules and Regulations", 
      "Liaising with MahaRERA Authorities", 
      "Drafting Necessary Applications, Undertakings, and Declarations"
    ]
  }, {
    "name": "Project De-Registration", 
    origin: "Compliance",
    "subServices": [
      "Consultation on De-Registration Prerequisites", 
      "Preparation of De-Registration Form", 
      "Preparation of Declaration/Undertaking Form", 
      "Drafting of Notarized Affidavit", 
      "Drafting of Consent Letter", 
      "Scrutiny Support", 
      "Coordination with MahaRERA Officials", 
      "Representation at MahaRERA Hearing", 
      "Comprehensive Deregistration Guidance"
    ]
  }, {
    "name": "Correction - Change of Other Details", 
    origin: "Compliance",
    "subServices": [
      "Assist in filing Correction Applications", 
      "Ensure accurate documentation and justification are submitted"
    ]
  }],
  "Package A": [{
    "name": "CONSULTATION & ADVISORY SERVICES", 
    origin: "Package A",
    "subServices": [
      "Comprehensive consultation regarding the RERA Act & Rules", 
      "Expert Guidance and updates on MahaRERA Orders & Regulations", 
      "Detailed insight into functioning of 100, 70% and 30% Bank Accounts & Procedures for withdrawals.", 
      "Advisory Services on contractual Agreements with buyers.", 
      "Preventive/Proactive advice with respect to compliances", 
      "Implementation of Consents from Allottees", 
      "Advisory Services on future withdrawals and further functioning of accounts"
    ]
  }, {
    "name": "QUATERLY PROGRESS REPORTS",
    origin: "Package A", 
    "subServices": [
      "Vetting of Form 1 (Architect Certificate) as per Annexure A (Regulation 3)", 
      "Vetting of Form 2 (Engineer Certificate) as per Annexure B (Regulation 3)", 
      "Vetting of Form 3 (CA Certificate) as per Annexure D (Regulation 3)", 
      "Drafting of Disclosure of Sold/Unsold Inventory as per Circular 29", 
      "Updation of Work Progress and Development work", 
      "Updation of Cost details (Estimated and Incurred)", 
      "Updation of Inventory Details, Building Details, Project Details, FSI Details & Status", 
      "Updation of Professional details including Channel Partner, Contractors and others", 
      "Filing of QPR Report to MahaRERA on quarterly basis"
    ]
  }, {
    "name": "RERA PROFILE UPDATION & COMPLIANCE", 
    origin: "Package A",
    "subServices": [
      "Updation of amended/revised permissions from the local planning authority", 
      "Updation of parking details", 
      "Updation and Amendment of Encumbrance Details (Finance/Legal)",
      "Updation of Litigation details", 
      "Updation of Promoter and Stakeholder details",
      "Updation of Communication and contact details", 
      "Updation of project professional details", 
      "Drafting assistance of Form 2A (Quality Assurance Certificate)", 
      "Modification & Amendment of Project Details.", 
      "Obtaining CERSAI Certificate in case of financial encumbrance."
    ]
  }, {
    "name": "MahaRERA PROCESS-LINKED APPLICATION SUPPORT", 
    origin: "Package A",
    "subServices": [
      "Project time extension under section 7(3)", 
      "Project Amendment under section 14(2)", 
      "Project Closure application on the receipt of the OC"
    ]
  }],
  "Package B": [{
    "name": "PROFESSIONAL CERTIFICATIONS", 
    origin: "Package B",
    "subServices": [
      "Preparing/Updating estimates related to cost of construction for the project",
      "Preparation and Certification of Form 2 (Engineers Certificate)",
      "Cost accounting as per RERA for evaluating the expenses incurred in the project as per Books of Accounts",
      "Preparing the detailed report of the Receipts of the Project as per RERA",
      "Constituting the valuation of the unsold inventory",
      "Preparation and Certification of Form 3 (CA Certificate)",
      "Recommendations with respect to modification or amendments to Form 3 (CA Certificate)", 
      "Consultation in Compilation of Form 3 (CA Certificate)", 
      "Advise on adhering to financial reporting and management practices mandated by RERA for the project"
    ]
  }],
  "Package C": [{
    "name": "RERA ANNUAL AUDIT CONSULTATION", 
    origin: "Package C",
    "subServices": [
      "Consultation regarding Examination of the Prescribed Registers, Books & Documents, and Relevant Records", 
      "Drafting assistance of Form 5 (Annual Report on Statement of Account) as per the Registers, Books & Documents", 
      "Certification & Submission of Form 5"
    ]
  }],
  "Package D": [{
    "name": "BESPOKE OFFERINGS", 
    origin: "Package D",
    "subServices": [
      "Conducting one training the Internal teams - Finance, Accounts, Sales, to provide an overview and understating of the RERA Regulation for smooth operation", 
      "Dedicated Relationship Manager as one Point of Contact", 
      "Accessibility for the RERA related queries and doubts", 
      "Coordinating with various teams to gather the required information, documents, and details for compliance completion."
    ]
  }, {
    "name": "REGULATORY HEARING & NOTICES", 
    origin: "Package D",
    "subServices": [
      "Handling and complying to the notices issued by the MahaRER", 
      "Replying to the notices and Suo-Moto orders being issued by MahaRERA for the particular project", 
      "Representing the Developers in front of Authorities", 
      "Appearing the Regulatory hearings imposed as Suo-Moto by the Authority"
    ]
  }],
  "Add ons": [{
    "name": "LIAISONING", 
    origin: "Add ons",
    "subServices": [
      "Liaising with MahaRERA authorities to ensure seamless communication between your organization and the regulatory body.", 
      "Managing complex documentation, addressing compliance challenges, and resolving regulatory disputes to prevent delays and ensure timely approvals."
    ]
  }, {
    "name": "LEGAL DOCUMENTATION", 
    origin: "Add ons",
    "subServices": [
      "Drafting of Agreement for Sale in Compliance with MahaRERA Regulations", 
      "Drafting of Allotment Letters in Compliance with MahaRERA Regulations", 
      "Preparation  and Submission of Deviation Reports for Agreement for Sale", 
      "Preparation and Submission of Deviation Reports for Allotment Letters", 
      "Vetting of Agreement for Sale in Compliance with MahaRERA Regulations", 
      "Vetting of Allotment Letters in Compliance with MahaRERA Regulations", 
      "Vetting and Submission of Deviation Reports for Agreement for Sale", 
      "Vetting and Submission of Deviation Reports for Allotment Letters"
    ]
  }, {
    "name": "TITLE REPORT", 
    origin: "Add ons",
    "subServices": [
      "Procurement of Title Certificate", 
      "Conducting Title Search/Preparation of Title Report"
    ]
  }, {
    "name": "Form 1", 
    origin: "Add ons",
    "hasYear": true,
    "hasQuarter": true,
    "subServices": [
      "Provide duly certified Form 1 (Architect Certificate) as required under MahaRERA for project registration and milestone-based withdrawals.", 
      "Verify and certify the percentage of construction completed in accordance with approved plans and RERA guidelines"
    ]
  }, {
    "name": "Form 2", 
    origin: "Add ons",
    "hasYear": true,
    "hasQuarter": true,
    "subServices": [
      "Provide Form 2 (Engineer’s Certificate) under MahaRERA, certifying the actual cost incurred on construction up to a specific stage.", 
      "The certificate is prepared in coordination with Form 1 (Architect’s Certificate) and Form 3 (CA’s Certificate) to ensure consistency across physical progress and financial reporting."
    ]
  }, {
    "name": "Form 3", 
    origin: "Add ons",
    "hasYear": true,
    "hasQuarter": true,
    "subServices": [
      "Provide certified Form 3 (Chartered Accountant Certificate) under MahaRERA, verifying the actual cost incurred on land and construction as per the cost accounting records shared by the client.", 
      "Assess and certify the proportionate fund withdrawal eligibility in alignment with project progress and compliance requirements"
    ]
  }, {
    "name": "Form 5 (CA RERA Audit Certificate)", 
    origin: "Add ons",
    "hasYear": true,
    "subServices": [
      "Drafting assistance of Form 5 (Annual Report on Statement of Account) as per the Registers, Books & Documents", 
      "Certification of Form 5"
    ]
  }, {
    "name": "Search Report", 
    origin: "Add ons",
    "subServices": [
      "Conduct thorough searches of public land records for title investigation", 
      "Provide details on ownership history, encumbrances, legal descriptions, and tax status", 
      "Support accurate and efficient preparation of land title reports for legal or transactional use"
    ]
  }, {
    "name": "SRO Membership", 
    origin: "Add ons",
    "subServices": [
      "Assist developers in obtaining SRO membership as mandated under MahaRERA guidelines for registered promoters.", 
      "Manage end-to-end application process, including documentation, eligibility verification, and coordination with recognized SRO bodies.", 
      "Ensure compliance with RERA norms by facilitating timely registration, renewals, and updates related to SRO membership"
    ]
  }, {
    "name": "Drafting of Title Report in Format A", 
    origin: "Add ons", 
    "subServices": [
      "Prepare comprehensive Title Report in Format A", 
      "Conduct detailed examination of land records, registered documents, and legal history", 
      "Ensure the report is legally sound and fully compliant with RERA guidelines"
    ]
  }],
  "Customized Header": [{
    "name": "ALL AVAILABLE SERVICES", 
    origin: "Customized Header",
    "subServices": []
  }]
};

// ---------------- PACKAGE LOGIC ----------------

const PACKAGE_HIERARCHY = {
  "Package A": ["Package A"],
  "Package B": ["Package A", "Package B"],
  "Package C": ["Package A", "Package B", "Package C"],
  "Package D": ["Package A", "Package B", "Package C", "Package D"],
};

export function isPackageHeader(header) {
  return Object.keys(PACKAGE_HIERARCHY).includes(header);
}

export function expandPackageServices(packageName) {
  const included = PACKAGE_HIERARCHY[packageName] || [packageName];
  const services = [];

  included.forEach(pkg => {
    (SERVICES[pkg] || []).forEach(service => {
      if (!services.some(s => s.name === service.name)) {
        services.push(service);
      }
    });
  });

  return services;
}

// New function to get all services
export function getAllServices() {
  const allServices = [];
  const serviceNames = new Set();
  
  // Iterate through all categories in SERVICES except 'Customized Header'
  for (const header of Object.keys(SERVICES).filter(h => h !== "Customized Header")) {
    (SERVICES[header] || []).forEach(service => {
      // Add the service if it hasn't been added yet
      if (!serviceNames.has(service.name)) {
        allServices.push({
          ...service,
          category: service.origin === 'Add ons' ? 'addon' : 'main'
        });
        serviceNames.add(service.name);
      }
    });
  }

  return allServices;
}

export function getServicesForHeader(header) {
  let mainServices = [];
  let addOnServices = [];

  if (isPackageHeader(header)) {
    const includedPackages = PACKAGE_HIERARCHY[header] || [header];
    includedPackages.forEach(pkg => {
      mainServices.push(...(SERVICES[pkg] || []));
    });
    addOnServices = (SERVICES["Add ons"] || []).map(s => ({ ...s, category: "addon" }));
  } else if (header === "Customized Header") {
    return getAllServices().map(s => ({ ...s, category: s.origin === 'Add ons' ? 'addon' : 'main' }));
  } else {
    mainServices = SERVICES[header] || [];
    addOnServices = (SERVICES["Add ons"] || []).map(s => ({ ...s, category: "addon" }));
  }

  return [
    ...mainServices.map(s => ({ ...s, category: "main" })),
    ...addOnServices,
  ];
}

export function getAvailableHeaders(selectedHeaders) {
  return HEADERS.filter((header) => !selectedHeaders.includes(header));
}